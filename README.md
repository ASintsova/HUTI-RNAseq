# Characterization of UPEC-specific pan-transcriptiome in patients with uncomplicated UTIs

## Summary

----------


## Methods

### Sample Collection

* Bacterial strains:
    * UTI urine samples were streaked out on MacConkey. Identity and antibiotic profile were determined using VITEK2 system. 
    * Strains were cultured statically at 37oC to midexponential phase - thought to correspond to conditions in the bladder
* RNA samples: 
    * clean catch midstream urine samples were immediately stabilized with 2x volumes of RNAprotect.
    * Cell pellets, obtained from centrifugation of human UTI urine were stored at -80oC. Cell pellets wer treated with Proteinase K, total RNA extracted with RNeasy mini kit. Turbo DNase (Ambion).

### Sequencing
#### _RNA sequencing_

Bacterial RNA content was enhanced by selective depletion of human RNA using MICROBEEnrich kit (Ambion). Libraries were prepared using ScriptSeq Complete Kit:

  * removes ribosomal RNA 
  * creates stranded Illumina sequencing library
  * coding and non-coding RNA
  * claims that only 100ng is required



#### _DNA sequencing_

??


### Quality Control


### Data Analysis
#### _Genome Assembly_
#### _RNAseq Read Mapping and Counting_

**Problem**: Gene annotations generated by prokka do not match up, cannot use them for gene expression comparisons between strains

**Solution**: Ali ran get-homologues to identify homologues between our 13 strain. This program produces output with a unique gene_id (which does not make much sense), and corresponding prokka gene number for each genome. Use this output to generate new gff files that will all have same gene_ids. This did not resolve the problem of paralogs. Have to be dropped at this point?

From Ali's get homolog output: one file for each homolog cluster, created one (this file: `/data/annotations/upec_homologs.fna`). From that generated gff file for all 13 genomes (this file: `/data/annotations/upec_gh_edited.gff`), separated this into each individual genome (all of these are in `/data/annotations`). Note that tese final gffs have fewere lines. Am I missing unique genes? Do I care about unique genes?

* Making of **upec_homologs.fna**

```
cd $DATA # folder with get-homologs output
for i in *fna
do 
FILE=$(ls $i)
echo ">>"${FILE%.*} > ${FILE%.*}"_name.fna"
cat $FILE >> ${FILE%.*}"_name.fna"
rm $FILE
done

cat *.fna > upec_homologs.fna

```

* Making of edited gff files (can be found in `/analysis/DE/lib/pbs_scripts`):

```
cd $DATA
while read p
do
python get_gffs_from_homolgs.py  "HM"$p"_gh.gff" "HM"$p".gff" 2
done < $SN/strain.numbers

```

or

```
cd $SN
python $CODE/get_gffs_from_homolgs.py upec_homologs.fna upec_homologs.gff 1
mv upec_homologs.gff $SN/Annotations
cd $SN/Annotations
while read p; do grep "^HM"$p"_1" upec_homologs.gff > "HM"$p"_gh.gff"; done < $SN/strain.numbers
```

* The python script can be found in `/analysis/DE/lib/pbs_scripts`


*Note: it is possible that further alterations were made to these scripts, it is beyond me at this point to de-convolute what I did*



**HTseq Count**: Using new gffs for annotation used htseq on flux to generate counts for each sample

* HTseq counts script is here: `/analysis/DE/lib/pbs_scripts`. Here's the gist:

```
DATA=/scratch/hmobley_fluxod/annasint/HUTI_RNAseq/Data
ALIGN=/scratch/hmobley_fluxod/annasint/HUTI_RNAseq/Data/Alignments/BAM_by_Position_New_Samples
ANNOT=/scratch/hmobley_fluxod/annasint/HUTI_RNAseq/Data/Annotations/get-homologs-gff
ANALYSIS=/scratch/hmobley_fluxod/annasint/HUTI_RNAseq/Analysis/core-genome-analysis/2017-01-30-htseq-counts

#htseq-count -f bam -r pos -m union -t CDS -s yes $ALIGN/UR17_SE_aln_sort.bam $ANNOT/HM17_gh.gff > HM17.out.1

for i in $ALIGN/*.bam
do
NUM=$(ls $i|sed -e s/[^0-9]//g)
NAM=$(ls $i|cut -d "/" -f9|cut -d "_" -f1)
htseq-count -f bam -r pos -m union -t CDS -s yes $i $ANNOT/"HM"$NUM"_gh_final.gff"> $ANALYSIS/$NAM
done


``` 

These counts were compared to Ali's and were found to be the same (random check)

#### Data Normalization

Normalization is designed to transform the distributions of abundances for each sample, without distortion, into distributions that can be compared.
 It accounts for differences in sequencing depths and in biases arising from the library preparation or its sequencing

#### _Differential Expression Analysis_

Used 





-----------

## Results

### Metabolism and Growth
### Adhesion
### Other Virulence Factors
### Type 2 Secretion System
### Non-coding RNAs
### Genetic determinants of gene expression

--------

## Discussion Points


-------
